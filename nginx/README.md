# Hack From Home: Nginx

This module contains the necessary files and folders that nginx will use to reverse-proxy the requests into the proper services.

## Dockerfile

The Docker image for this container is based entirely on the latest version of the docker image `nginx`. The only added statement copies the static files generated by ReactJS' build script to a folder inside the container.

## Logging of requests and errors

The local folder `log` will be mounted inside the container as the folder located in `/var/nginx/log/`, through a volume set up in the `docker-compose.yml` file. There, two files will be present: `error.log` and `access.log`.

Each time nginx handles a request, it will append an entry to one of the two files, depending on whether the request caused an error or not, respectively.

While it is true that there is no need to set up a volume, it is useful in the case where we want to access the logs without having to enter the nginx container. A simple `tail -f access.log` executed in the host computer will be enough to check in real-time the requests made to the server.

## Configuration

The file `conf/nginx.conf` will replace the default configuration of nginx, which is located inside the container in `/etc/nginx/nginx.conf`. In this configuration file, we have set up different things:
 - The logging paths of the accesses and the errors.
 - The amount of simultaneous workers that will handle the requests made to the reverse-proxy.
 - The path to which the requests to the API will be redirected.
 - The port that the reverse-proxy will listen on.
 - A correspondence between the extension of a file being served and the MIME type header that will be sent with the response.
 - A reverse-proxy rule that will redirect every request made to `/api/(.*)` (that's a RegEx rule) to the API server.
 - A reverse-proxy rule that will redirect every other request to the static files generated by ReactJS' build script.
